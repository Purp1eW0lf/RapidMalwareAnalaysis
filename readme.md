# Rapid Malware Analysis supporting repo


## Exiftool and file

The command `file` is likely to be installed in most unix, MacOS, and linux OS'. Deploy it next to the file you want to interrograte
![image](https://user-images.githubusercontent.com/44196051/203073884-6cb75b6b-2e56-4022-b84e-e881d1556214.png)


`exiftool` may have to be installed on your respective OS, but is deplopyed similarly be firing it off next to the file you want to know more about

![image](https://user-images.githubusercontent.com/44196051/203073768-113b96fe-8f55-4f59-a94e-38b0f07e20d8.png)
![image](https://user-images.githubusercontent.com/44196051/203073793-48a81542-28af-4070-a44d-1db994a32bb6.png)

![image](https://user-images.githubusercontent.com/44196051/203073820-527290e8-a216-434e-9e2c-a1b7f19421e9.png)



## Thor

[Florian Roth's](https://twitter.com/cyb3rops) Thor requires you to agree to a licence before it can be used. 

There are versions of Thor, but we'll be using [the free, `lite` version](https://www.nextron-systems.com/thor-lite/)

What I'd reccomend you do here is create a dedicated directory (`/malware/folder`), and put one file in at a time into this directory that you want to study.

```bash
#execute Thor
./thor-lite-macosx -a FileScan \ 
-p /Malware/folder:NOWALK -e /malware/folder \
--nothordb --allreasons --utc --intense --nocsv --silent --brd

#open the HTML report THOR creates
open /malware/folder/*.html
```

![image](https://user-images.githubusercontent.com/44196051/203074016-c1d7e3f6-c556-4b3c-81ae-968790a18089.png)
![image](https://user-images.githubusercontent.com/44196051/203074079-0a245735-a444-4f6a-9382-58c10f49801c.png)


## Capa
[Capa](https://github.com/mandiant/capa) is simply to execute pointed at the portable executable in question

```bash
capa malware.exe
```

![image](https://user-images.githubusercontent.com/44196051/203074411-8a4c0159-0d1a-4176-bef2-18539fd131a7.png)
![image](https://user-images.githubusercontent.com/44196051/203074460-53929a8d-206b-4907-9829-d24baffdca34.png)


## Sysmon as a malware lab

Run this [script](https://gist.github.com/Purp1eW0lf/d669db5cfca9b020a7f7c982a8256deb), which will install Sysmon and Ippsec's Sysmon-steamliner script (powersiem.ps1)

Run powersiem.ps1, then detonate your malware. In PowerSiem's output, you will see the affects of the malware on the host

```powershell
#download script

wget -useb https://gist.githubusercontent.com/Purp1eW0lf/d669db5cfca9b020a7f7c982a8256deb/raw/4848ba4d32ccbf1ebeb62c8d3409fca2bcdf2799/Sysmon_Lab.ps1 -outfile ./Sysmon_Lab.ps1

#start sysmon lab
./Sysmon_Lab.ps1

#start powersiem.ps1
C:\users\*\Desktop\SysmonLab\PowerSiem.ps1

#detonate malware
```


![image](https://user-images.githubusercontent.com/44196051/203074507-c1dc874e-254a-4f2e-aa87-881ee0975cae.png)
![image](https://user-images.githubusercontent.com/44196051/203074562-ff4ee6d4-5beb-4cc8-9174-a9e0f9e76442.png)

